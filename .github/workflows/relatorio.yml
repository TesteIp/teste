- name: Criar p치gina no Confluence
        id: create_confluence_page  # Adicionado um ID para capturar a sa칤da
        env:
          CONFLUENCE_USER: ${{ secrets.email }}  # Token de usu치rio
          CONFLUENCE_API_TOKEN: ${{ secrets.testecon }}  # Token da API
        run: |
          PAGE_TITLE="Relat칩rio de Commits da PR #${{ github.event.pull_request.number }} no reposit칩rio '${{ github.repository }}'"
          CONFLUENCE_URL="https://joaovictorcaoki.atlassian.net/wiki/rest/api/content"
          SPACE_KEY="DDS"  # O espa칞o Confluence que voc칡 deseja usar
          PARENT_PAGE_ID="65784"  # ID da p치gina pai (pasta)
          
          # Ler o conte칰do do relat칩rio gerado
          REPORT_CONTENT=$(cat report_content.txt)

          # Criar uma nova p치gina no Confluence para o PR na pasta espec칤fica
          response=$(curl -u "${CONFLUENCE_USER}:${CONFLUENCE_API_TOKEN}" \
            -X POST \
            -H "Content-Type: application/json" \
            --data '{
              "type": "page",
              "title": "'"$PAGE_TITLE"'",
              "space": {
                "key": "'"$SPACE_KEY"'"
              },
              "ancestors": [
                {
                  "id": "'"$PARENT_PAGE_ID"'"
                }
              ],
              "body": {
                "storage": {
                  "value": "'"${REPORT_CONTENT}"' ",
                  "representation": "storage"
                }
              }
            }' "https://joaovictorcaoki.atlassian.net/wiki/rest/api/content")

          # Extrair o ID da p치gina criada a partir da resposta
          PAGE_ID=$(echo $response | jq -r '.id')
          # Salvar a URL da nova p치gina como uma sa칤da do passo
          echo "::set-output name=page_url::https://joaovictorcaoki.atlassian.net/wiki/spaces/${SPACE_KEY}/pages/${PAGE_ID}"

      - name: Comentar na PR com o link da p치gina do Confluence
        if: github.event.pull_request.base.ref == 'master'  # Garante que s칩 ser치 feito para PRs para 'master'
        uses: actions/github-script@v6
        with:
          github-token: ${{ secrets.PAT_TOKEN }}
          script: |
            const prNumber = ${{ github.event.pull_request.number }};
            const confluencePageUrl = "${{ steps.create_confluence_page.outputs.page_url }}";  // Link da p치gina espec칤fica do Confluence
            const commentBody = `
              ### 游닇 Relat칩rio de Commits

              Voc칡 pode acessar o relat칩rio de commits detalhado na p치gina do Confluence [aqui](${confluencePageUrl}).
            `;
            await github.rest.issues.createComment({
              ...context.repo,
              issue_number: prNumber,
              body: commentBody,
            });